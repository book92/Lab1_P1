<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Giữ nguyên phần head -->
</head>
<body>
    <!-- Giữ nguyên phần body HTML -->

    <script>
        // Giữ nguyên phần cấu hình Firebase và các hàm hỗ trợ

        // Thay đổi hàm formatSpecs
        function formatSpecs(specs) {
            return Object.entries(specs)
                .map(([key, value]) => `${key}: ${value}`)
                .join('<br>');
        }

        // Thay đổi phần xử lý và hiển thị dữ liệu thiết bị
        try {
            deviceData = JSON.parse(dataParam);
            console.log("Parsed device data:", deviceData);

            // Hiển thị thông tin thiết bị
            displayDeviceInfo('deviceName', deviceData.name);
            // Hiển thị cả tên và email người dùng
            displayDeviceInfo('deviceUser', `${deviceData.user || ''} ${deviceData.userEmail ? `(${deviceData.userEmail})` : ''}`);
            displayDeviceInfo('deviceType', deviceData.type);
            displayDeviceInfo('deviceNotes', deviceData.notes);
            displayDeviceInfo('departmentName', deviceData.department);

            // Xử lý thông số kỹ thuật
            if (deviceData.specs && Object.keys(deviceData.specs).length > 0) {
                document.getElementById('deviceSpecs').innerHTML = formatSpecs(deviceData.specs);
            } else {
                document.getElementById('deviceSpecs').textContent = 'Không có thông tin';
            }
        } catch (error) {
            console.error("Error parsing device data:", error);
            // Hiển thị thông báo lỗi nếu việc phân tích dữ liệu thất bại
            ['deviceName', 'deviceUser', 'deviceType', 'deviceSpecs', 'deviceNotes', 'departmentName'].forEach(id => {
                displayDeviceInfo(id, 'Lỗi khi đọc dữ liệu');
            });
        }

        // Giữ nguyên phần xử lý sự kiện báo lỗi

    </script>
</body>
</html>
